# Ước tính cơ thể người từ 6 cảm biến quán tính chi phí thấp trong thời gian thực

## Abstract: Trừu tượng

Khả năng ghi lại chuyển động của con người từ các cảm biến quán tính đã cho thấy tiềm năng lớn so với các phương pháp tiếp tập dựa trên hình ảnh vì không gặp phải hạn chế về không gian hoạt động trong một phạm vi cố định và tắc nghẽn do các bộ phận cơ thể bị che khuất. Các nghiên cứu SOTA gần đây sử dụng cảm biến quán tính chuyên dụng của Xsens và Noitom có giá thành rất cao đồng thời yêu cầu hệ thống máy tính sử dụng GPU dẫn đến việc triển khai trở nên tốn kém và khó phổ biến. Việc ghi lại chuyển động thời gian thực sử dụng cảm biến quán tính chi phí thấp và triển khai trên máy tính cấu hình thấp chỉ sử dụng CPU là một thách thức. Để đạt được mục đích này, chúng tôi trình bày tái tạo kết quả của bài báo Transpose bằng cách sử dụng 6 cảm biến quán tính Hi229 chi phí thấp và tối ưu hóa mạng Neural Network để đạt được 24 FPS trên CPU i5-5200U trong thời gian thực. Các thí nghiệm chứng minh rằng các cảm biến quán tính chi phí thấp có thể được sử dụng để ghi lại chuyển động với độ chính xác và ổn định theo thời gian.

Keywords: IMU, Pose Estimation, Inverse Kinematics, Real-time, Low-cost

## 1\. Introduction:

### 1.1\. Background:

Chụp chuyển động của con người (mocap), nhằm mục đích tái tạo lại các chuyển động cơ thể con người 3D, đóng một vai trò quan trọng trong các ứng dụng khác nhau như chơi game, thể thao, y học, VR / AR và sản xuất phim. Cho đến nay, các giải pháp mocap dựa trên tầm nhìn chiếm phần lớn trong chủ đề này. Một danh mục yêu cầu gắn các điểm đánh dấu quang học trên cơ thể người và sử dụng nhiều máy ảnh để theo dõi các điểm đánh dấu để ghi lại chuyển động. Các hệ thống dựa trên điểm đánh dấu như [Vicon](https://www.vicon.com/) được áp dụng rộng rãi và được coi là đủ chính xác cho việc sử dụng công nghiệp. Tuy nhiên, những cách tiếp cận như vậy yêu cầu cơ sở hạ tầng đắt tiền và các thiết bị xâm nhập, điều này khiến chúng không được mong muốn đối với cách sử dụng ở cấp độ người tiêu dùng. Gần đây, một danh mục khác tập trung vào ước tính tư thế sử dụng một vài máy ảnh RGB hoặc RGB-D [Chen et al. 2020];[Habibie et al. 2019];[Mehtaet al. 2020];[Tome et al. 2018];[Trumble et al. 2016];[Xiang et al. 2019]. Mặc dù các phương pháp này nhẹ hơn nhiều, nhưng chúng rất nhạy cảm với sự xuất hiện của con người vì các đặc điểm phân biệt cần được trích xuất từ hình ảnh. Do đó, các phương pháp này thường hoạt động kém hiệu quả đối với môi trường ánh sáng khó khăn. Hơn nữa, tất cả các phương pháp tiếp cận dựa trên thị lực đều bị tắc. Một vấn đề như vậy đôi khi có thể được giải quyết bằng cách đặt các camera dày đặc (điều này càng làm cho hệ thống trở nên nặng nề và tốn kém), nhưng nó thường không thực tế trong một số ứng dụng. Ví dụ, rất khó bố trí máy ảnh trong một phòng sinh hoạt chung có đầy đủ đồ đạc hoặc vật dụng, điều này có thể làm chủ thể bị che khuất từ bất kỳ hướng nào. Một hạn chế khác của phương pháp tiếp cận dựa trên tầm nhìn là những người biểu diễn thường bị hạn chế trong một không gian cố định. Đối với các hoạt động hàng ngày như đi bộ và chạy trong phạm vi lớn, cần phải có camera chuyển động được kiểm soát cẩn thận để ghi lại đủ thông tin chuyển động, điều này rất khó đạt được [Xu et al. 2016]. Những nhược điểm này là những sai sót nghiêm trọng đối với nhiều ứng dụng và do đó dẫn đến khả năng sử dụng hạn chế của các giải pháp dựa trên tầm nhìn.

Trái ngược với các hệ thống dựa trên thị giác, việc ghi lại chuyển động bằng cảm biến đeo trên người không phụ thuộc vào môi trường và không bị tắc nghẽn. Nó không yêu cầu thiết lập cơ sở phức tạp và không có ràng buộc về phạm vi chuyển động. Các đặc điểm như vậy làm cho nó phù hợp hơn với các mục đích sử dụng ở cấp độ khách hàng. Do đó, chụp chuyển động bằng cảm biến quán tính ngày càng được chú trọng hơn trong những năm gần đây. Hầu hết các công việc liên quan đều sử dụng Đơn vị đo lường quán tính (IMU) để ghi lại quán tính chuyển động, tiết kiệm, nhẹ, đáng tin cậy và thường được sử dụng trong một số lượng lớn các thiết bị đeo được như đồng hồ, dây đeo tay và kính. Hệ thống mocap quán tính thương mại [Xsens](https://www.xsens.com/) sử dụng 17 IMU để ước tính độ quay của khớp. Mặc dù chính xác, vị trí dày đặc của các IMU là bất tiện, ngăn cản người biểu diễn di chuyển tự do. Mặt khác, các yêu cầu về cơ sở vật chất đối với một hệ thống như vậy vẫn nằm ngoài khả năng chấp nhận của các khách hàng bình thường. Công việc của SIP [Marcard et al. 2017] chứng minh rằng việc tái tạo lại chuyển động của con người chỉ từ 6 IMU là hoàn toàn khả thi. Tuy nhiên, là một phương pháp dựa trên tối ưu hóa, nó cần phải truy cập vào toàn bộ trình tự và mất nhiều thời gian để xử lý. Nghiên cứu mới nhất sau đây DIP [Huang et al. 2018] đạt được hiệu suất thời gian thực với chất lượng tốt hơn bằng cách tận dụng RNN hai chiều, cũng sử dụng 6 IMU. Tuy nhiên, nó vẫn không thành công ở các tư thế khó và tốc độ khung hình 30 khung hình / giây không đủ để chụp các chuyển động nhanh, rất phổ biến trong các ứng dụng thực tế. Quan trọng hơn, nó chỉ ước tính tư thế cơ thể mà không có chuyển động toàn cầu, vốn cũng quan trọng trong nhiều ứng dụng như VR và AR. Bản thân IMU không có khả năng đo khoảng cách trực tiếp. Một số nghiên cứu trước đây [Liu et al. 2011]; [Vlasic et al. 2007] sử dụng các cảm biến siêu âm bổ sung để đo dịch toàn cầu, đắt tiền và có thể bị tắc. Các giải pháp khả thi khác sử dụng tính năng định vị GPS, cách này không đủ chính xác và chỉ hoạt động khi chụp ngoài trời. Do đó, ước tính siêu thời gian thực của cả tư thế cơ thể và dịch toàn cục từ các cảm biến đeo thưa vẫn còn là một vấn đề còn bỏ ngỏ.

Vì vậy, chúng tôi giới thiệu cách tiếp cận của mình, tái tạo kết quả của bài báo TransPose, ước tính các bản dịch toàn cầu và tư thế cơ thể chỉ từ 6 IMU [Hi229](http://hipnuc.com/) chi phí thấp real-time với CPU i5-5200U ở tốc độ 24 khung hình/giây với độ chính xác hiện đại. Thực hiện chụp chuyển động từ các IMU thưa thớt là vô cùng khó khăn, vì vấn đề đang bị hạn chế nghiêm trọng. Chúng tôi đề xuất xây dựng nhiệm vụ ước lượng đặt ra theo 2 giai đoạn bao gồm: chuyển đổi đầu vào IMU thành đâu vào model Transpose, và chuyển đổi model Pytorch sang ONNX. Kết quả là, toàn bộ đường ống của chúng tôi đạt được hiệu suất thời gian chạy real-time trên CPU.

### 1.2\. Motivation: Động lực

Các nghiên cứu SOTA gần đây hầu hết sử dụng các cảm biến quán tính chuyên dụng của Xsens và Noitom, rất đắt tiền, làm cho việc triển khai thực tế rất khó khăn và khó phổ biến. Không có một cách tiếp cận nào sử dụng cảm biến quán tính chi phí thấp. Tuy nhiên, tác phẩm này chúng tôi đã giữ nguyên ý tưởng của bài báo Transpose, thực hiện chuyển đổi hệ tọa độ IMU từ Local sang Global. Bên cạnh đó, thiết kế model tối ưu chạy theo thời gian thực trên CPU cũng đóng một vai trò quan trọng để hạ thấp yêu cầu cấu hình máy tính. Nghiên cứu tập trung vào việc triển khai lại kết quả của bài báo Transpose sử dụng cảm biến chi phí thấp và môi trường máy tính cấu hình thấp chỉ sử dụng CPU không yêu cầu GPU.

### 1.3\. Objectives and Contributions:  Mục tiêu và đóng góp

Mục tiêu của nghiên cứu này là triển khai lại kết quả bài báo Transpose bằng cách sử dụng cảm biến quán tính chi phí thấp và yêu cầu cấu hình máy chỉ cần CPU. Đáng chú ý, luận án này đề xuất cách chuyển đổi hệ tọa độ từ hệ tọa độ local của từng cảm biến thành hệ tọa độ global liên hệ tất cả các cảm biến. Bên cạch đó luận án này đóng góp chuyển đổi framework neuralnetwork nghiên cứu Python sang framework ONNX chuyên cho việc tối ưu cho triển khai.

### 1.4\. Organization: Tổ chức

Bài viết này được cấu trúc như sau. Chương 2 giới thiệu các nghiên cứu tài liệu liên quan đến luận án. Chương 3 trình bày chi tiết các chiến lược của chúng tôi, bao gồm kiến trúc mô phỏng tùy chỉnh và phương pháp giảng dạy. Chương 4 trình bày việc thực hiện thiết kế và các thí nghiệm. Chương 5 kết thúc luận án và đề xuất công việc trong tương lai

Bài viết này được cấu trúc như sau. Chương 2 giới thiệu các nghiên cứu tài liệu liên quan đến luận án. Chương 3 ... Chương 4 ...

## 2\. Related work: Công việc liên quan:

Chụp chuyển động của con người (mocap) đã có lịch sử nghiên cứu lâu đời. Nhiều nghiên cứu đã được dành cho chủ đề này, chủ yếu có thể được phân loại thành các phương pháp tiếp cận quang học, quán tính và lai. Vì phương pháp của chúng tôi chỉ yêu cầu các phép đo IMU làm đầu vào, nên chúng tôi không thảo luận về các phương pháp tiếp cận dựa trên hình ảnh thuần túy [15, 16, 24, 27, 40, 48, 58]. Ở đây, chúng tôi tập trung vào các giải pháp mocap lai và quán tính.

### 2.1\. Optical-inertial Hybrid Motion Capture: Chụp chuyển động lai quán tính quang học. 

Khi các giải pháp mocap dựa trên hình ảnh bị hiện tượng tắc nghẽn, việc kết hợp hình ảnh với IMU, nhằm mục đích đạt được khả năng theo dõi chuyển động mạnh mẽ hơn, gần đây đã thu hút nhiều sự chú ý. Điều này có thể đạt được bằng cách tối ưu hóa dựa trên [22, 36–38,43,65], tối ưu hóa tư thế người để phù hợp với cả các đặc điểm hình ảnh và phép đo quán tính hoặc ước tính dựa trên tính năng [13, 62] trong đó hồi quy tư thế của con người từ các tính năng kết hợp có nguồn gốc từ hình ảnh và IMU. Zhang và cộng sự. [87] đề xuất khai thác IMU trong ước tính tư thế 2D bằng cách kết hợp các đặc điểm hình ảnh của từng cặp khớp được liên kết bởi IMU. Một số hoạt động kết hợp IMU với hình ảnh độ sâu [18, 23, 90] hoặc điểm đánh dấu quang học 1 để thực hiện chụp chuyển động / hiệu suất của con người. Tuy nhiên, các phương pháp này vẫn còn hạn chế đáng kể trong điều kiện ánh sáng yếu và tắc nghẽn, đồng thời yêu cầu phải di chuyển trong tầm nhìn của máy ảnh. Phương pháp của chúng tôi không yêu cầu đầu vào hình ảnh và do đó không có những hạn chế này.

### 2.2\. Motion Capture from Inertial Sensors: Chụp chuyển động từ cảm biến quán tính. 

Phương pháp tiếp cận mocap quán tính không bị tắc nghẽn hoặc hạn chế không gian di chuyển. Các giải pháp thương mại [34, 71] và công việc mở rộng [14] dựa vào 17 IMU để thực hiện chụp chuyển động. Họ thường yêu cầu mặc một bộ đồ bó sát với các IMU dày đặc, điều này gây bất tiện và cản trở. Rõ ràng là nên có một bộ IMU giảm bớt trên cơ thể. Tuy nhiên, việc chụp chuyển động từ các cảm biến quán tính thưa thớt là rất mơ hồ và khó khăn. Một số nghiên cứu [31, 59, 64] sử dụng cảm biến siêu âm để có thêm thông tin vị trí nhằm giải quyết một số điểm mơ hồ, nhưng việc sử dụng cảm biến khoảng cách sẽ hạn chế phạm vi hoạt động. Các kết quả đầu tiên thuần túy quán tính [47, 57, 60]  sử dụng gia tốc kế thưa thớt để tái tạo lại tư thế của con người bằng cách tìm kiếm cơ sở dữ liệu. Schwarz và cộng sự. [50] sử dụng các phép đo định hướng thưa thớt để thực hiện ước tính tư thế dành riêng cho từng người. Để cải thiện độ chính xác, các nghiên cứu gần đây [12, 20, 44, 66, 73] sử dụng cả phép đo gia tốc và định hướng. Marcard và cộng sự. [66] trình bày một phương pháp ngoại tuyến để chụp chuyển động của con người chỉ từ 6 IMU, đạt được độ chính xác đầy hứa hẹn. Huang và cộng sự. [20] đề xuất phương pháp học sâu đầu tiên, sử dụng mạng nơ-ron lặp lại hai chiều (biRNN) để ước tính tư thế con người từ 6 IMU trong thời gian thực. Tuy nhiên, phương pháp của họ không cho phép xác định vị trí của người đó trong không gian 3D. Phương pháp hiện đại nhất, TransPose [73], giới thiệu khung ước lượng dịch và tư thế thời gian thực đầu tiên, giúp đạt được chất lượng chụp chính xác trong khi cũng chỉ sử dụng 6 IMU.

Tuy nhiên, tất cả các tác phẩm này đều có độ trễ không đáng kể do nhu cầu thông tin trong tương lai vốn có, không thể chụp ổn định các tư thế mơ hồ và có nhiều hiện vật phi vật lý như rung và trượt chân. Ngược lại, phương pháp của chúng tôi không dựa vào bất kỳ thông tin nào trong tương lai và không bị chậm trễ trong khi thậm chí đạt được độ chính xác cao hơn. Ngoài ra, chúng tôi là người đầu tiên kết hợp tối ưu hóa chuyển động dựa trên vật lý với chụp chuyển động quán tính thưa thớt và chúng tôi cho thấy rằng một thiết kế được tổ chức cẩn thận như vậy sẽ cải thiện đáng kể độ chính xác vật lý của chuyển động.

## 3\. Method: Phương pháp

Nhiệm vụ của chúng tôi là ước tính các tư thế và bản dịch của chủ đề trong thời gian thực bằng cách sử dụng 6 IMU. Như được hiển thị trong Hình 3, 6 IMU được gắn trên xương chậu, chân dưới bên trái và bên phải, cẳng tay trái và phải và đầu. Sau đây, chúng tôi đề cập đến các khớp nối này ngoại trừ xương chậu, được đặt tên là khớp gốc. Chúng tôi chia nhiệm vụ này thành hai nhiệm vụ: Chuyển đổi hệ tọa độ từ hệ tọa độ local của từng cảm biến thành hệ tọa độ global liên hệ tất cả các cảm biến (Phần 3.2) và chuyển đổi framework neuralnetwork nghiên cứu Python sang framework ONNX chuyên cho việc tối ưu cho triển khai (Phần 3.3).

![image](https://user-images.githubusercontent.com/99313947/178130401-fe8f0574-9933-4405-8f33-716dbce70e4a.png)
Hình 3. Vị trí IMU. 6 IMU được gắn trên cẳng tay trái và phải, cẳng chân trái và phải, đầu và xương chậu. Chúng tôi yêu cầu các cảm biến được kết dính chặt chẽ xung quanh các khớp với các hướng tùy ý.

### 3.1\. System Input: Đầu vào hệ thống

Chúng tôi lấy số đo vòng quay và gia tốc của mỗi IMU làm đầu vào tổng thể của hệ thống. Chúng tôi sắp xếp các phép đo này vào cùng một hệ quy chiếu và chuẩn hóa chúng để thu được vectơ đầu vào nối liền là 𝒙 (0) = [Rroot, · · ·, Rrarm, Rroot, · · ·, Rrarm] ∈ R 72 trong đó 𝒂 ∈ R 3 là gia tốc và 𝑹 ∈ R 3 × 3 là ma trận quay. Chúng tôi sử dụng 𝒙 (0) (𝑡) để chỉ các phép đo của khung thứ 𝑡 và chỉ số trên (0) có nghĩa là nó là đầu vào tổng thể. Vui lòng tham khảo Phụ lục A để biết thêm chi tiết về tiền xử lý cảm biến.

### 3.2\. Convert Local - Global:

![image](https://user-images.githubusercontent.com/99313947/178130727-5ea3a0ac-a583-45b6-8d80-46c79b8b7e9d.png)

### 3.3\. Convert Pytorch - ONNX:

![image](https://user-images.githubusercontent.com/99313947/178130684-6cc7fc80-11de-4426-b7db-3b272c8770e8.png)



